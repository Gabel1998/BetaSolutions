<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="da">
<head th:replace="~{fragments/header :: head}">
    <title>Medarbejderbelastning pr. dag</title>
    <!-- Link workload.css som det sidste stylesheet -->
    <link rel="stylesheet" th:href="@{/css/workload.css}" />
</head>
<body>

<!-- Header fra dit fragment -->
<div th:replace="~{fragments/header :: header}"></div>

<main class="container">
    <h1>Medarbejderbelastning pr. dag</h1>

    <!-- Hvis ingen data -->
    <p th:if="${workload == null or #maps.isEmpty(workload)}">
        Der er ingen data at vise.
    </p>

    <!-- For hver medarbejder (map => Entry) -->
    <div th:if="${workload != null and !#maps.isEmpty(workload)}"
         th:each="empEntry : ${workload.entrySet()}">
        <section class="employee-section">
            <h2 th:text="'Medarbejder: ' + ${employeeNames[empEntry.key]}">
                Medarbejder: Emil Hansen
            </h2>

            <div style="position: relative;">
                <div class="axis-label-y">Timer (y-akse)</div>

                <div class="bar-container bar-chart">
                    <!-- For hver dag i den medarbejders indre map -->
                    <div th:each="dayEntry : ${empEntry.value.entrySet()}"
                         th:with="
                   day       = dayEntry.key;
                   stats     = dayEntry.value;
                   hours     = stats.first;
                   pct       = stats.second;
                   clamped   = (pct > 100 ? 100 : pct);
                   overPct   = (pct > 100 ? pct - 100 : 0);
                   normalPx  = (clamped * hours * 10) + 'px';
                   overPx    = (overPct * hours * 10) + 'px'
                 "
                         class="bar"
                         th:title="|${#temporals.format(day,'dd/MM/yyyy')}: ${hours} t (${pct}% )|">

                        <div class="bar-normal"
                             th:style="|height:${normalPx}|"></div>

                        <div class="bar-over"
                             th:if="${overPct > 0}"
                             th:style="|height:${overPx}|"></div>

                        <span th:text="${#temporals.format(day,'dd/MM')}"></span>
                    </div>
                </div>

                <div class="axis-label-x">Dato (x-akse)</div>
            </div>
        </section>
    </div>
</main>

<!-- Footer fra dit fragment -->
<div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>
